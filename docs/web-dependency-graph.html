<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web Dependency Graph</title>
    <style>
      :root {
        --bg: #f7f8fa;
        --panel: #ffffff;
        --line: #dde2ea;
        --text: #1d2433;
        --muted: #54607a;
        --accent: #1f6feb;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        padding: 20px;
        font-family: 'IBM Plex Sans', 'Segoe UI', sans-serif;
        background: var(--bg);
        color: var(--text);
      }
      h1, h2, h3 {
        margin: 0 0 10px;
      }
      .meta {
        color: var(--muted);
        font-size: 14px;
      }
      .summary {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 12px 0 16px;
      }
      .chip {
        background: #eef3ff;
        border: 1px solid #d3e0ff;
        border-radius: 999px;
        padding: 6px 10px;
        font-size: 13px;
      }
      .controls {
        display: grid;
        grid-template-columns: 1fr 180px auto;
        gap: 8px;
        margin-bottom: 12px;
      }
      .controls input,
      .controls select,
      .controls button {
        border: 1px solid var(--line);
        border-radius: 8px;
        padding: 10px;
        background: var(--panel);
        font-size: 14px;
      }
      .controls button {
        cursor: pointer;
      }
      .layout {
        display: grid;
        grid-template-columns: minmax(260px, 0.9fr) minmax(500px, 1.5fr) minmax(320px, 1fr);
        gap: 12px;
      }
      .panel {
        background: var(--panel);
        border: 1px solid var(--line);
        border-radius: 12px;
        padding: 12px;
        min-height: 520px;
      }
      .panel h2 {
        font-size: 17px;
      }
      .list {
        height: 470px;
        overflow: auto;
        margin: 8px 0 0;
        padding: 0;
        list-style: none;
        border-top: 1px solid var(--line);
      }
      .list-item {
        display: block;
        width: 100%;
        text-align: left;
        background: none;
        border: none;
        border-bottom: 1px solid #edf1f6;
        padding: 9px 8px;
        cursor: pointer;
        font-family: inherit;
      }
      .list-item:hover {
        background: #f6f9ff;
      }
      .list-item.active {
        background: #e9f0ff;
      }
      .node-path {
        display: block;
        font-family: ui-monospace, 'SFMono-Regular', Menlo, monospace;
        font-size: 12px;
      }
      .node-meta {
        color: var(--muted);
        font-size: 12px;
      }
      .graph-wrap {
        width: 100%;
        height: 500px;
        overflow: auto;
        border: 1px solid var(--line);
        border-radius: 8px;
        background: #fbfcfe;
      }
      svg {
        display: block;
      }
      .detail {
        border-top: 1px solid var(--line);
        padding-top: 10px;
        margin-top: 8px;
      }
      .detail h3 {
        margin: 10px 0 4px;
        font-size: 14px;
      }
      .detail pre {
        white-space: pre-wrap;
        margin: 0;
        font-size: 12px;
        line-height: 1.4;
        color: #28334d;
        background: #f7f9fd;
        border: 1px solid #e5eaf4;
        border-radius: 8px;
        padding: 8px;
      }
      .detail-list {
        margin: 4px 0 0;
        padding: 0;
        list-style: none;
      }
      .detail-list li {
        padding: 4px 0;
        border-bottom: 1px dotted #edf1f6;
        font-family: ui-monospace, 'SFMono-Regular', Menlo, monospace;
        font-size: 12px;
      }
      .zone-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 8px;
      }
      .zone-table th,
      .zone-table td {
        border-bottom: 1px solid #edf1f6;
        text-align: left;
        padding: 6px;
        font-size: 12px;
      }
      @media (max-width: 1200px) {
        .layout {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <h1>Web Dependency Graph</h1>
    <div class="meta">Source: <code>packages/web/src</code> | Generated: <span id="generatedAt"></span></div>
    <div id="summary" class="summary"></div>

    <div class="controls">
      <input id="searchInput" type="search" placeholder="Search file path, zone, or intent header text" />
      <select id="zoneFilter"></select>
      <button id="clearFilters">Reset Filters</button>
    </div>

    <div class="layout">
      <section class="panel">
        <h2>Modules</h2>
        <div class="meta" id="visibleCount"></div>
        <ul id="nodeList" class="list"></ul>
      </section>

      <section class="panel">
        <h2>Dependency Graph</h2>
        <div class="graph-wrap">
          <svg id="graphSvg"></svg>
        </div>
      </section>

      <section class="panel">
        <h2>Module Details</h2>
        <div id="details" class="detail"></div>
      </section>
    </div>

    <section class="panel" style="min-height: 180px; margin-top: 12px;">
      <h2>Zone Dependency Edges</h2>
      <table class="zone-table">
        <thead>
          <tr>
            <th>Source zone</th>
            <th>Target zone</th>
            <th>Edge count</th>
          </tr>
        </thead>
        <tbody id="zoneEdgeRows"></tbody>
      </table>
    </section>

    <script>
      const DATA = {"generatedAt":"2026-02-21T05:41:28.173Z","sourceRoot":"packages/web/src","summary":{"fileCount":100,"edgeCount":231,"zoneCount":11,"externalImportCount":39},"zones":[{"zone":"hud","fileCount":48},{"zone":"space","fileCount":16},{"zone":"renderers","fileCount":13},{"zone":"api","fileCount":7},{"zone":"platform","fileCount":5},{"zone":"auth","fileCount":3},{"zone":"contracts","fileCount":3},{"zone":"hooks","fileCount":2},{"zone":"App.tsx","fileCount":1},{"zone":"config","fileCount":1},{"zone":"main.tsx","fileCount":1}],"zoneEdges":[{"sourceZone":"api","targetZone":"api","count":6},{"sourceZone":"App.tsx","targetZone":"api","count":1},{"sourceZone":"App.tsx","targetZone":"auth","count":3},{"sourceZone":"App.tsx","targetZone":"config","count":1},{"sourceZone":"App.tsx","targetZone":"hooks","count":1},{"sourceZone":"App.tsx","targetZone":"hud","count":1},{"sourceZone":"App.tsx","targetZone":"platform","count":1},{"sourceZone":"auth","targetZone":"api","count":1},{"sourceZone":"auth","targetZone":"auth","count":1},{"sourceZone":"contracts","targetZone":"contracts","count":2},{"sourceZone":"hooks","targetZone":"api","count":2},{"sourceZone":"hooks","targetZone":"hooks","count":1},{"sourceZone":"hud","targetZone":"api","count":9},{"sourceZone":"hud","targetZone":"auth","count":1},{"sourceZone":"hud","targetZone":"config","count":1},{"sourceZone":"hud","targetZone":"contracts","count":2},{"sourceZone":"hud","targetZone":"hooks","count":15},{"sourceZone":"hud","targetZone":"hud","count":86},{"sourceZone":"hud","targetZone":"platform","count":10},{"sourceZone":"hud","targetZone":"renderers","count":1},{"sourceZone":"main.tsx","targetZone":"App.tsx","count":1},{"sourceZone":"main.tsx","targetZone":"renderers","count":1},{"sourceZone":"platform","targetZone":"api","count":1},{"sourceZone":"platform","targetZone":"contracts","count":3},{"sourceZone":"platform","targetZone":"hud","count":1},{"sourceZone":"platform","targetZone":"platform","count":5},{"sourceZone":"platform","targetZone":"space","count":1},{"sourceZone":"renderers","targetZone":"api","count":3},{"sourceZone":"renderers","targetZone":"hooks","count":2},{"sourceZone":"renderers","targetZone":"renderers","count":23},{"sourceZone":"space","targetZone":"contracts","count":7},{"sourceZone":"space","targetZone":"hooks","count":5},{"sourceZone":"space","targetZone":"platform","count":2},{"sourceZone":"space","targetZone":"renderers","count":2},{"sourceZone":"space","targetZone":"space","count":28}],"nodes":[{"id":"api/auth.ts","zone":"api","title":"Auth API functions — session management.","summary":"Auth API functions — session management.","intentHeader":"Auth API functions — session management.","internalImports":["api/client.ts"],"externalImports":[],"importedBy":["App.tsx","auth/AuthDialog.tsx"],"internalImportCount":1,"importedByCount":2,"externalImportCount":0},{"id":"api/client.ts","zone":"api","title":"API client — typed fetch wrapper for all API calls.","summary":"API client — typed fetch wrapper for all API calls.","intentHeader":"API client — typed fetch wrapper for all API calls.\n\nReads sessionId from localStorage, adds Authorization header,\nreturns typed JSON responses.","internalImports":[],"externalImports":[],"importedBy":["api/auth.ts","api/interest.ts","api/organisms.ts","api/surface.ts","hooks/use-organism.ts"],"internalImportCount":0,"importedByCount":5,"externalImportCount":0},{"id":"api/files.ts","zone":"api","title":"File URL helpers — resolves media fileReference values to public URLs.","summary":"File URL helpers — resolves media fileReference values to public URLs.","intentHeader":"File URL helpers — resolves media fileReference values to public URLs.","internalImports":[],"externalImports":[],"importedBy":["renderers/audio.tsx","renderers/song.tsx"],"internalImportCount":0,"importedByCount":2,"externalImportCount":0},{"id":"api/interest.ts","zone":"api","title":"Interest API — guest email capture for demo-gated panels.","summary":"Interest API — guest email capture for demo-gated panels.","intentHeader":"Interest API — guest email capture for demo-gated panels.","internalImports":["api/client.ts"],"externalImports":[],"importedBy":["hud/panels/core/GuestAccessPrompt.tsx","hud/panels/core/RegisterInterestForm.tsx"],"internalImportCount":1,"importedByCount":2,"externalImportCount":0},{"id":"api/organisms.ts","zone":"api","title":"Organism API functions — typed wrappers for organism endpoints.","summary":"Organism API functions — typed wrappers for organism endpoints.","intentHeader":"Organism API functions — typed wrappers for organism endpoints.\n\nRequest/response contracts come from the local API types module so\nrendering stays decoupled from kernel package imports.","internalImports":["api/client.ts","api/types.ts"],"externalImports":[],"importedBy":["api/surface.ts","hooks/use-organism.ts","hud/panels/forms/ProposeForm.tsx","hud/panels/forms/ThresholdForm.tsx","hud/panels/organism/sections/CompositionSection.tsx","hud/panels/organism/sections/OrganismPicker.tsx","hud/panels/organism/sections/ProposalsSection.tsx","platform/Platform.tsx"],"internalImportCount":2,"importedByCount":8,"externalImportCount":0},{"id":"api/surface.ts","zone":"api","title":"surfaceOnWorldMap — places a newly thresholded organism onto the world map.","summary":"surfaceOnWorldMap — places a newly thresholded organism onto the world map.","intentHeader":"surfaceOnWorldMap — places a newly thresholded organism onto the world map.\n\nFetches the current spatial-map state, checks for duplicate entries,\nappends the new entry, and calls appendState to persist it.\n\nRetries transient failures to tolerate concurrent writes that race on\nsequence number allocation. Re-reads current map state between attempts\nso the final write always merges with the latest entries.","internalImports":["api/client.ts","api/organisms.ts"],"externalImports":[],"importedBy":["hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"api/types.ts","zone":"api","title":"Web API types — request/response contracts consumed by the rendering layer.","summary":"Web API types — request/response contracts consumed by the rendering layer.","intentHeader":"Web API types — request/response contracts consumed by the rendering layer.\n\nMirrors API payload shapes locally so the web package never imports the\nkernel directly. Keep this file aligned with backend route contracts.","internalImports":[],"externalImports":[],"importedBy":["api/organisms.ts","hud/panels/organism/sections/relationships-presenter.ts","renderers/registry.ts"],"internalImportCount":0,"importedByCount":3,"externalImportCount":0},{"id":"App.tsx","zone":"App.tsx","title":"App — top-level rendering shell.","summary":"App — top-level rendering shell.","intentHeader":"App — top-level rendering shell.\n\nResolves auth/session state and routes into the platform rendering\nflow, including the adaptive visor harness mode.","internalImports":["api/auth.ts","auth/auth-request.ts","auth/AuthDialog.tsx","auth/session.ts","config/runtime-flags.ts","hooks/use-organism.ts","hud/panels/core/AdaptiveVisorHarness.tsx","platform/index.ts"],"externalImports":["react"],"importedBy":["main.tsx"],"internalImportCount":8,"importedByCount":1,"externalImportCount":1},{"id":"auth/auth-request.ts","zone":"auth","title":"Auth request bus — lightweight event bridge for opening auth UI.","summary":"Auth request bus — lightweight event bridge for opening auth UI.","intentHeader":"Auth request bus — lightweight event bridge for opening auth UI.\n\nLets panel-level guest prompts request authentication without coupling\ndeeply to app-shell state.","internalImports":[],"externalImports":[],"importedBy":["App.tsx","hud/panels/core/GuestAccessPrompt.tsx"],"internalImportCount":0,"importedByCount":2,"externalImportCount":0},{"id":"auth/AuthDialog.tsx","zone":"auth","title":"AuthDialog — non-blocking login/signup overlay.","summary":"AuthDialog — non-blocking login/signup overlay.","intentHeader":"AuthDialog — non-blocking login/signup overlay.\n\nAllows guests to authenticate without leaving the current platform view.","internalImports":["api/auth.ts","auth/session.ts"],"externalImports":["react"],"importedBy":["App.tsx"],"internalImportCount":2,"importedByCount":1,"externalImportCount":1},{"id":"auth/session.ts","zone":"auth","title":"AuthSession — authenticated user context returned by /auth/me.","summary":"AuthSession — authenticated user context returned by /auth/me.","intentHeader":"AuthSession — authenticated user context returned by /auth/me.","internalImports":[],"externalImports":[],"importedBy":["App.tsx","auth/AuthDialog.tsx"],"internalImportCount":0,"importedByCount":2,"externalImportCount":0},{"id":"config/runtime-flags.ts","zone":"config","title":"Runtime flags — centralized web behavior switches.","summary":"Runtime flags — centralized web behavior switches.","intentHeader":"Runtime flags — centralized web behavior switches.\n\nKeeps demo-mode and guest-access strategy decisions in one place so\npanel rendering can stay declarative and consistent.","internalImports":[],"externalImports":[],"importedBy":["App.tsx","hud/panels/core/GuestAccessPrompt.tsx"],"internalImportCount":0,"importedByCount":2,"externalImportCount":0},{"id":"contracts/altitude.ts","zone":"contracts","title":"Altitude contract — shared zoom-level vocabulary across web features.","summary":"Altitude contract — shared zoom-level vocabulary across web features.","intentHeader":"Altitude contract — shared zoom-level vocabulary across web features.\n\nKeeps altitude typing independent from any single feature implementation\nso orchestration and rendering can coordinate through one neutral contract.","internalImports":[],"externalImports":[],"importedBy":["contracts/index.ts","platform/adaptive-visor-compositor.ts","platform/PlatformContext.tsx","space/AltitudeControls.tsx","space/ambient/space-ambient-layer-contract.ts","space/GroundPlane.tsx","space/SpaceLayer.tsx","space/SpaceOrganism.tsx","space/use-viewport.ts","space/viewport-math.ts"],"internalImportCount":0,"importedByCount":10,"externalImportCount":0},{"id":"contracts/index.ts","zone":"contracts","title":null,"summary":null,"intentHeader":null,"internalImports":["contracts/altitude.ts","contracts/visor-widget.ts"],"externalImports":[],"importedBy":[],"internalImportCount":2,"importedByCount":0,"externalImportCount":0},{"id":"contracts/visor-widget.ts","zone":"contracts","title":"Visor widget contract — shared adaptive widget identity vocabulary.","summary":"Visor widget contract — shared adaptive widget identity vocabulary.","intentHeader":"Visor widget contract — shared adaptive widget identity vocabulary.\n\nDefines the stable widget ID set used by adaptive visor policy,\ntemplate slots, and rendering registration.","internalImports":[],"externalImports":[],"importedBy":["contracts/index.ts","hud/contracts/adaptive-visor-behavior-contract.ts","hud/panels/core/widget-schema.ts","platform/adaptive-visor-compositor.ts"],"internalImportCount":0,"importedByCount":4,"externalImportCount":0},{"id":"hooks/use-is-surfaced.ts","zone":"hooks","title":"useIsSurfaced — checks whether an organism appears on a map.","summary":"useIsSurfaced — checks whether an organism appears on a map.","intentHeader":"useIsSurfaced — checks whether an organism appears on a map.\n\nLoads the map's spatial-map state and checks if the given organism ID\nappears in the entries array.","internalImports":["hooks/use-organism.ts"],"externalImports":[],"importedBy":["hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"hooks/use-organism.ts","zone":"hooks","title":"Data-fetching hooks for organism data.","summary":"Data-fetching hooks for organism data.","intentHeader":"Data-fetching hooks for organism data.\n\nEach hook calls one API function and returns { data, loading, error }.","internalImports":["api/client.ts","api/organisms.ts"],"externalImports":["react"],"importedBy":["App.tsx","hooks/use-is-surfaced.ts","hud/AdaptiveVisorHost.tsx","hud/panels/map/HudMyProposalsPanel.tsx","hud/panels/organism/OrganismPanelDeck.tsx","hud/panels/organism/sections/AppendSection.tsx","hud/panels/organism/sections/ComponentsSection.tsx","hud/panels/organism/sections/CompositionSection.tsx","hud/panels/organism/sections/ContributionsSection.tsx","hud/panels/organism/sections/GovernanceSection.tsx","hud/panels/organism/sections/ProposalsSection.tsx","hud/panels/organism/sections/ProposeSection.tsx","hud/panels/organism/sections/RelationshipsSection.tsx","hud/panels/organism/sections/StateHistorySection.tsx","hud/panels/organism/sections/VitalitySection.tsx","hud/widgets/VitalityWidget.tsx","renderers/hero-journey-scene.tsx","renderers/song.tsx","space/OrganismInterior.tsx","space/SpaceLayer.tsx","space/SpaceNavBar.tsx","space/SpaceOrganism.tsx","space/use-spatial-map.ts"],"internalImportCount":2,"importedByCount":23,"externalImportCount":1},{"id":"hud/AdaptiveVisorHost.tsx","zone":"hud","title":"AdaptiveVisorHost — unified adaptive rendering host across visor contexts.","summary":"AdaptiveVisorHost — unified adaptive rendering host across visor contexts.","intentHeader":"AdaptiveVisorHost — unified adaptive rendering host across visor contexts.\n\nIn adaptive mode, panel rendering flows through one context-driven host\nso map and organism interactions share the same panel mechanics and\ncollapsed rail placement rules.","internalImports":["hooks/use-organism.ts","hud/panels/core/panel-body-registry.tsx","hud/panels/core/panel-layout-policy.ts","hud/panels/core/panel-schema.ts","hud/panels/core/template-schema.ts","hud/panels/core/use-main-panel-history-navigation.ts","hud/panels/core/VisorPanelDeck.tsx","hud/panels/organism/OrganismPanelDeck.tsx","hud/widgets/index.ts","platform/adaptive-visor-compositor.ts","platform/index.ts"],"externalImports":[],"importedBy":["hud/Hud.tsx"],"internalImportCount":11,"importedByCount":1,"externalImportCount":0},{"id":"hud/contracts/adaptive-visor-behavior-contract.ts","zone":"hud","title":"Adaptive visor behavior contract — explicit policy agreement for layout orchestration.","summary":"Adaptive visor behavior contract — explicit policy agreement for layout orchestration.","intentHeader":"Adaptive visor behavior contract — explicit policy agreement for layout orchestration.\n\nCaptures the expected adaptive visor state space, event vocabulary, and\ndeterministic layout/compositor outcomes independent from React rendering.\n\nDesign spikes and implementation tests both reference this contract so\nbehavior iteration stays coherent as presentation evolves.","internalImports":["contracts/visor-widget.ts","hud/cues/cue-schema.ts","hud/panels/core/panel-schema.ts","platform/adaptive-visor-compositor.ts"],"externalImports":[],"importedBy":[],"internalImportCount":4,"importedByCount":0,"externalImportCount":0},{"id":"hud/cues/cue-placement.ts","zone":"hud","title":"Cue placement — computes popup coordinates relative to a target anchor.","summary":"Cue placement — computes popup coordinates relative to a target anchor.","intentHeader":"Cue placement — computes popup coordinates relative to a target anchor.\n\nPrefers showing the cue above the anchor. Falls back below when there\nis not enough top space. Placement is clamped to viewport bounds.","internalImports":[],"externalImports":[],"importedBy":["hud/cues/HudCueLayer.tsx"],"internalImportCount":0,"importedByCount":1,"externalImportCount":0},{"id":"hud/cues/cue-policy.ts","zone":"hud","title":"Cue policy — deterministic selection of context-aware HUD cues.","summary":"Cue policy — deterministic selection of context-aware HUD cues.","intentHeader":"Cue policy — deterministic selection of context-aware HUD cues.\n\nFor the first cue iteration, show adaptive help once per session\nwhen adaptive visor mode is enabled.","internalImports":["hud/cues/cue-schema.ts"],"externalImports":[],"importedBy":["hud/cues/HudCueLayer.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"hud/cues/cue-schema.ts","zone":"hud","title":"Cue schema — context-aware popup metadata for adaptive HUD guidance.","summary":"Cue schema — context-aware popup metadata for adaptive HUD guidance.","intentHeader":"Cue schema — context-aware popup metadata for adaptive HUD guidance.\n\nCues are separate from panels and widgets. They can target anchors and\nprovide short-lived guidance or awareness hints.","internalImports":[],"externalImports":[],"importedBy":["hud/contracts/adaptive-visor-behavior-contract.ts","hud/cues/cue-policy.ts","hud/cues/HudCueLayer.tsx"],"internalImportCount":0,"importedByCount":3,"externalImportCount":0},{"id":"hud/cues/HudCueLayer.tsx","zone":"hud","title":"HudCueLayer — renders context-aware cue popups for the HUD.","summary":"HudCueLayer — renders context-aware cue popups for the HUD.","intentHeader":"HudCueLayer — renders context-aware cue popups for the HUD.\n\nThe initial implementation shows an adaptive-help cue once per browser\nsession.","internalImports":["hud/cues/cue-placement.ts","hud/cues/cue-policy.ts","hud/cues/cue-schema.ts"],"externalImports":["react"],"importedBy":["hud/Hud.tsx"],"internalImportCount":3,"importedByCount":1,"externalImportCount":1},{"id":"hud/extensions/hud-extension-contract.ts","zone":"hud","title":"HUD extension contract — installable rendering add-ons for visor/HUD behavior.","summary":"HUD extension contract — installable rendering add-ons for visor/HUD behavior.","intentHeader":"HUD extension contract — installable rendering add-ons for visor/HUD behavior.\n\nThis defines a stable manifest shape for future installable HUD apps while\nkeeping all writes routed through existing API capability checks.","internalImports":[],"externalImports":[],"importedBy":[],"internalImportCount":0,"importedByCount":0,"externalImportCount":0},{"id":"hud/extensions/proposal-experience-registry.tsx","zone":"hud","title":"Proposal experience registry — resolves proposal panel rendering behavior.","summary":"Proposal experience registry — resolves proposal panel rendering behavior.","intentHeader":"Proposal experience registry — resolves proposal panel rendering behavior.\n\nKeeps the default proposal flow intact while introducing a narrow extension\nseam for future installable visor/HUD proposal experiences.","internalImports":["hud/panels/organism/sections/index.ts"],"externalImports":["react"],"importedBy":["hud/panels/core/panel-body-registry.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":1},{"id":"hud/Hud.tsx","zone":"hud","title":"Hud — the Visor's rendering layer.","summary":"Hud — the Visor's rendering layer.","intentHeader":"Hud — the Visor's rendering layer.\n\nThe visor is adaptive-only. Rendering always flows through the\nadaptive host so map, interior, and organism contexts share one\npolicy-driven panel system.","internalImports":["hud/AdaptiveVisorHost.tsx","hud/cues/HudCueLayer.tsx","platform/adaptive-visor-compositor.ts","platform/index.ts"],"externalImports":["react"],"importedBy":["hud/index.ts"],"internalImportCount":4,"importedByCount":1,"externalImportCount":1},{"id":"hud/index.ts","zone":"hud","title":null,"summary":null,"intentHeader":null,"internalImports":["hud/Hud.tsx"],"externalImports":[],"importedBy":["platform/Platform.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/core/AdaptiveVisorHarness.tsx","zone":"hud","title":"AdaptiveVisorHarness — local orchestration harness for panel slot behavior.","summary":"AdaptiveVisorHarness — local orchestration harness for panel slot behavior.","intentHeader":"AdaptiveVisorHarness — local orchestration harness for panel slot behavior.\n\nProvides a quick, isolated surface to iterate context, panel eligibility,\nand promotion/collapse behavior without loading platform state or API data.","internalImports":["hud/panels/core/panel-layout-policy.ts","hud/panels/core/panel-schema.ts","hud/panels/core/template-schema.ts","hud/panels/core/VisorPanelDeck.tsx"],"externalImports":["react"],"importedBy":["App.tsx"],"internalImportCount":4,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/core/GuestAccessPrompt.tsx","zone":"hud","title":"GuestAccessPrompt — unified guest gating surface for write-only panels.","summary":"GuestAccessPrompt — unified guest gating surface for write-only panels.","intentHeader":"GuestAccessPrompt — unified guest gating surface for write-only panels.\n\nStrategy is runtime-configurable: either collect interest emails or\nnudge guests into authentication.","internalImports":["api/interest.ts","auth/auth-request.ts","config/runtime-flags.ts","hud/panels/core/RegisterInterestForm.tsx"],"externalImports":[],"importedBy":["hud/panels/map/HudMyProposalsPanel.tsx","hud/panels/map/HudProfilePanel.tsx","hud/panels/organism/sections/ProposeSection.tsx"],"internalImportCount":4,"importedByCount":3,"externalImportCount":0},{"id":"hud/panels/core/intent-matrix.ts","zone":"hud","title":"Intent matrix — declarative panel intent rules for adaptive visor layout.","summary":"Intent matrix — declarative panel intent rules for adaptive visor layout.","intentHeader":"Intent matrix — declarative panel intent rules for adaptive visor layout.\n\nCaptures context + organism mode behavior as data so panel policy can\nremain a thin deterministic resolver. This keeps iteration fast without\nhardwiring flow assumptions into host components.","internalImports":["hud/panels/core/panel-schema.ts"],"externalImports":[],"importedBy":["hud/panels/core/panel-layout-policy.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/core/panel-body-registry.tsx","zone":"hud","title":"Panel body registry — typed body renderers for adaptive panel IDs.","summary":"Panel body registry — typed body renderers for adaptive panel IDs.","intentHeader":"Panel body registry — typed body renderers for adaptive panel IDs.\n\nKeeps panel-body mapping in one contract so hosts and deck wrappers can\nroute by panel ID without per-host branching. Coverage is exhaustive by\npanel ID type for map and universal visor panel groups.","internalImports":["hud/extensions/proposal-experience-registry.tsx","hud/panels/core/panel-schema.ts","hud/panels/map/HudMyProposalsPanel.tsx","hud/panels/map/HudProfilePanel.tsx","hud/panels/organism/sections/index.ts"],"externalImports":["react"],"importedBy":["hud/AdaptiveVisorHost.tsx","hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":5,"importedByCount":2,"externalImportCount":1},{"id":"hud/panels/core/panel-layout-policy.ts","zone":"hud","title":"Visor panel layout policy — assigns panel roles for adaptive rendering.","summary":"Visor panel layout policy — assigns panel roles for adaptive rendering.","intentHeader":"Visor panel layout policy — assigns panel roles for adaptive rendering.\n\nThe policy resolves which eligible panel is main, which become secondary,\nand which remain collapsed. Output is deterministic from context + intent.","internalImports":["hud/panels/core/intent-matrix.ts","hud/panels/core/panel-schema.ts","hud/panels/core/template-schema.ts"],"externalImports":[],"importedBy":["hud/AdaptiveVisorHost.tsx","hud/panels/core/AdaptiveVisorHarness.tsx","hud/panels/core/VisorPanelDeck.tsx","hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":3,"importedByCount":4,"externalImportCount":0},{"id":"hud/panels/core/panel-schema.ts","zone":"hud","title":"Panel schema — unified adaptive panel contract for map and visor contexts.","summary":"Panel schema — unified adaptive panel contract for map and visor contexts.","intentHeader":"Panel schema — unified adaptive panel contract for map and visor contexts.\n\nDefines panel identity, eligibility, role support, and priority hints.\nThe adaptive layout policy consumes this schema to assign main,\nsecondary, and collapsed roles deterministically.","internalImports":[],"externalImports":[],"importedBy":["hud/AdaptiveVisorHost.tsx","hud/contracts/adaptive-visor-behavior-contract.ts","hud/panels/core/AdaptiveVisorHarness.tsx","hud/panels/core/intent-matrix.ts","hud/panels/core/panel-body-registry.tsx","hud/panels/core/panel-layout-policy.ts","hud/panels/core/template-schema.ts","hud/panels/core/use-main-panel-history-navigation.ts","hud/panels/core/VisorPanelDeck.tsx","hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":0,"importedByCount":10,"externalImportCount":0},{"id":"hud/panels/core/panel-ux.tsx","zone":"hud","title":"Panel UX primitives — consistent status and empty-state surfaces for panels.","summary":"Panel UX primitives — consistent status and empty-state surfaces for panels.","intentHeader":"Panel UX primitives — consistent status and empty-state surfaces for panels.\n\nCentralizes loading/empty/error/auth-required rendering so panel features\nshare one predictable interaction contract.","internalImports":[],"externalImports":["react"],"importedBy":["hud/panels/map/HudMyProposalsPanel.tsx","hud/panels/organism/sections/AppendSection.tsx","hud/panels/organism/sections/ComponentsSection.tsx","hud/panels/organism/sections/ContributionsSection.tsx","hud/panels/organism/sections/GovernanceSection.tsx","hud/panels/organism/sections/ProposalsSection.tsx","hud/panels/organism/sections/ProposeSection.tsx","hud/panels/organism/sections/RelationshipsSection.tsx","hud/panels/organism/sections/StateHistorySection.tsx"],"internalImportCount":0,"importedByCount":9,"externalImportCount":1},{"id":"hud/panels/core/RegisterInterestForm.tsx","zone":"hud","title":"RegisterInterestForm — reusable guest CTA for gated demo interactions.","summary":"RegisterInterestForm — reusable guest CTA for gated demo interactions.","intentHeader":"RegisterInterestForm — reusable guest CTA for gated demo interactions.\n\nCaptures an email so visitors can register interest without creating\nan account during the V1 demo phase.","internalImports":["api/interest.ts"],"externalImports":["react"],"importedBy":["hud/panels/core/GuestAccessPrompt.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/core/template-schema.ts","zone":"hud","title":"Visor template schema — defines adaptive slot topology by context.","summary":"Visor template schema — defines adaptive slot topology by context.","intentHeader":"Visor template schema — defines adaptive slot topology by context.\n\nTemplates describe how the visor arranges panel roles (main, secondary,\ncollapsed), where widgets are allowed, and which anchor spaces are\npermanently reserved. The layout policy consumes template slot values.","internalImports":["hud/panels/core/panel-schema.ts","hud/panels/core/widget-schema.ts"],"externalImports":[],"importedBy":["hud/AdaptiveVisorHost.tsx","hud/panels/core/AdaptiveVisorHarness.tsx","hud/panels/core/panel-layout-policy.ts","hud/panels/core/VisorPanelDeck.tsx","hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":2,"importedByCount":5,"externalImportCount":0},{"id":"hud/panels/core/use-main-panel-history-navigation.ts","zone":"hud","title":"Main panel history navigation hook — tracks and navigates promoted main panels.","summary":"Main panel history navigation hook — tracks and navigates promoted main panels.","intentHeader":"Main panel history navigation hook — tracks and navigates promoted main panels.\n\nKeeps a bounded history of main panel promotions for one visor context so\nhistory-navigation widgets can move backward and forward without coupling to\npanel deck rendering details.","internalImports":["hud/panels/core/panel-schema.ts"],"externalImports":["react"],"importedBy":["hud/AdaptiveVisorHost.tsx","hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":1,"importedByCount":2,"externalImportCount":1},{"id":"hud/panels/core/VisorPanelDeck.tsx","zone":"hud","title":"VisorPanelDeck — shared adaptive panel deck for map and visor contexts.","summary":"VisorPanelDeck — shared adaptive panel deck for map and visor contexts.","intentHeader":"VisorPanelDeck — shared adaptive panel deck for map and visor contexts.\n\nResolves panel roles (main, secondary, collapsed) from panel schema and\nrenders promotion/collapse affordances with swap transitions.","internalImports":["hud/panels/core/panel-layout-policy.ts","hud/panels/core/panel-schema.ts","hud/panels/core/template-schema.ts"],"externalImports":["react"],"importedBy":["hud/AdaptiveVisorHost.tsx","hud/panels/core/AdaptiveVisorHarness.tsx","hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":3,"importedByCount":3,"externalImportCount":1},{"id":"hud/panels/core/widget-schema.ts","zone":"hud","title":"Widget schema — shared adaptive widget identity and purpose registry.","summary":"Widget schema — shared adaptive widget identity and purpose registry.","intentHeader":"Widget schema — shared adaptive widget identity and purpose registry.\n\nDefines the complete set of visor widget IDs so template slots and\norchestration policies can reference one stable vocabulary.","internalImports":["contracts/visor-widget.ts"],"externalImports":[],"importedBy":["hud/panels/core/template-schema.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/forms/ProposeForm.tsx","zone":"hud","title":"ProposeForm — form for offering a new state to an organism.","summary":"ProposeForm — form for offering a new state to an organism.","intentHeader":"ProposeForm — form for offering a new state to an organism.\n\nAdapts based on openTrunk: open-trunk organisms get direct appendState,\nregulated organisms get openProposal. Same form, different API call,\ndifferent heading.","internalImports":["api/organisms.ts"],"externalImports":["react"],"importedBy":["hud/panels/organism/sections/AppendSection.tsx","hud/panels/organism/sections/ProposeSection.tsx"],"internalImportCount":1,"importedByCount":2,"externalImportCount":1},{"id":"hud/panels/forms/ThresholdForm.tsx","zone":"hud","title":"ThresholdForm — form for introducing a new organism to the platform.","summary":"ThresholdForm — form for introducing a new organism to the platform.","intentHeader":"ThresholdForm — form for introducing a new organism to the platform.\n\nCollects content type, payload, and open-trunk preference. On submit,\ncalls thresholdOrganism and notifies the parent via onCreated.","internalImports":["api/organisms.ts"],"externalImports":["react"],"importedBy":["hud/panels/organism/sections/CompositionSection.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/map/HudMyProposalsPanel.tsx","zone":"hud","title":"HudMyProposalsPanel — map-level view of the current user's authored proposals.","summary":"HudMyProposalsPanel — map-level view of the current user's authored proposals.","intentHeader":"HudMyProposalsPanel — map-level view of the current user's authored proposals.\n\nGroups proposals by open/integrated/declined status and caps each group\nby default to keep the map panel readable.","internalImports":["hooks/use-organism.ts","hud/panels/core/GuestAccessPrompt.tsx","hud/panels/core/panel-ux.tsx","hud/panels/map/my-proposals-presenter.ts","hud/panels/organism/sections/format-date.ts","platform/index.ts"],"externalImports":["react"],"importedBy":["hud/panels/core/panel-body-registry.tsx"],"internalImportCount":6,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/map/HudProfilePanel.tsx","zone":"hud","title":"HudProfilePanel — placeholder map profile surface.","summary":"HudProfilePanel — placeholder map profile surface.","intentHeader":"HudProfilePanel — placeholder map profile surface.\n\nStarts as intentionally lightweight copy plus current session anchors.\nThis panel will eventually absorb richer regulation-focused profile data.","internalImports":["hud/panels/core/GuestAccessPrompt.tsx","platform/index.ts"],"externalImports":[],"importedBy":["hud/panels/core/panel-body-registry.tsx"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/map/my-proposals-presenter.ts","zone":"hud","title":"My proposals presenter — groups authored proposals for map panel rendering.","summary":"My proposals presenter — groups authored proposals for map panel rendering.","intentHeader":"My proposals presenter — groups authored proposals for map panel rendering.\n\nKeeps sort, group, and cap logic outside React so the proposals panel\ncan stay rendering-focused and test behavior in isolation.","internalImports":[],"externalImports":[],"importedBy":["hud/panels/map/HudMyProposalsPanel.tsx"],"internalImportCount":0,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/organism/OrganismPanelDeck.tsx","zone":"hud","title":"OrganismPanelDeck — shared organism tending panel deck.","summary":"OrganismPanelDeck — shared organism tending panel deck.","intentHeader":"OrganismPanelDeck — shared organism tending panel deck.\n\nEncapsulates adaptive panel behavior for tending a single organism so\nevery visor context uses one consistent panel system.","internalImports":["api/surface.ts","hooks/use-is-surfaced.ts","hooks/use-organism.ts","hud/panels/core/panel-body-registry.tsx","hud/panels/core/panel-layout-policy.ts","hud/panels/core/panel-schema.ts","hud/panels/core/template-schema.ts","hud/panels/core/use-main-panel-history-navigation.ts","hud/panels/core/VisorPanelDeck.tsx","hud/panels/organism/sections/index.ts","hud/widgets/index.ts","platform/index.ts","renderers/index.ts"],"externalImports":["react"],"importedBy":["hud/AdaptiveVisorHost.tsx"],"internalImportCount":13,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/organism/sections/AppendSection.tsx","zone":"hud","title":"AppendSection — appends state directly for open-trunk organisms.","summary":"AppendSection — appends state directly for open-trunk organisms.","intentHeader":"AppendSection — appends state directly for open-trunk organisms.\n\nOpen-trunk organisms bypass proposal evaluation, so append-state is\nsurfaced as its own dedicated panel instead of proposal panels.","internalImports":["hooks/use-organism.ts","hud/panels/core/panel-ux.tsx","hud/panels/forms/ProposeForm.tsx"],"externalImports":["react"],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":3,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/organism/sections/ComponentsSection.tsx","zone":"hud","title":"ComponentsSection — read-only list of composed child organisms.","summary":"ComponentsSection — read-only list of composed child organisms.","intentHeader":"ComponentsSection — read-only list of composed child organisms.\n\nUsed by renderer preview thermal mode to reveal which children are\ncurrently available for rendered composition.","internalImports":["hooks/use-organism.ts","hud/panels/core/panel-ux.tsx","platform/index.ts"],"externalImports":[],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":3,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/organism/sections/CompositionSection.tsx","zone":"hud","title":"CompositionSection — displays and manages an organism's composition.","summary":"CompositionSection — displays and manages an organism's composition.","intentHeader":"CompositionSection — displays and manages an organism's composition.\n\nShows parent link, children list with decompose action, and compose\nactions (existing organism or create-and-compose). Child and parent\nclicks open the target in the Visor.","internalImports":["api/organisms.ts","hooks/use-organism.ts","hud/panels/forms/ThresholdForm.tsx","hud/panels/organism/sections/OrganismPicker.tsx","platform/index.ts"],"externalImports":["react"],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":5,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/organism/sections/ContributionsSection.tsx","zone":"hud","title":"ContributionsSection — displays credited contribution signals per user.","summary":"ContributionsSection — displays credited contribution signals per user.","intentHeader":"ContributionsSection — displays credited contribution signals per user.\n\nUses the organism contributions read model so rendering stays decoupled\nfrom proposal/state/event query internals.","internalImports":["hooks/use-organism.ts","hud/panels/core/panel-ux.tsx","hud/panels/organism/sections/format-date.ts"],"externalImports":[],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":3,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/organism/sections/format-date.ts","zone":"hud","title":"formatDate — shared date formatting for universal layer sections.","summary":"formatDate — shared date formatting for universal layer sections.","intentHeader":"formatDate — shared date formatting for universal layer sections.","internalImports":[],"externalImports":[],"importedBy":["hud/panels/map/HudMyProposalsPanel.tsx","hud/panels/organism/sections/ContributionsSection.tsx","hud/panels/organism/sections/index.ts","hud/panels/organism/sections/ProposalsSection.tsx","hud/panels/organism/sections/StateHistorySection.tsx","hud/panels/organism/sections/VitalitySection.tsx","hud/widgets/VitalityWidget.tsx"],"internalImportCount":0,"importedByCount":7,"externalImportCount":0},{"id":"hud/panels/organism/sections/GovernanceSection.tsx","zone":"hud","title":"GovernanceSection — displays governance status of an organism.","summary":"GovernanceSection — displays governance status of an organism.","intentHeader":"GovernanceSection — displays governance status of an organism.\n\nChecks children for policy organisms (integration-policy content type)\nand shows whether the organism is open or regulated.","internalImports":["hooks/use-organism.ts","hud/panels/core/panel-ux.tsx"],"externalImports":[],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/organism/sections/index.ts","zone":"hud","title":null,"summary":null,"intentHeader":null,"internalImports":["hud/panels/organism/sections/AppendSection.tsx","hud/panels/organism/sections/ComponentsSection.tsx","hud/panels/organism/sections/CompositionSection.tsx","hud/panels/organism/sections/ContributionsSection.tsx","hud/panels/organism/sections/format-date.ts","hud/panels/organism/sections/GovernanceSection.tsx","hud/panels/organism/sections/ProposalsSection.tsx","hud/panels/organism/sections/ProposeSection.tsx","hud/panels/organism/sections/RelationshipsSection.tsx","hud/panels/organism/sections/StateHistorySection.tsx","hud/panels/organism/sections/VitalitySection.tsx"],"externalImports":[],"importedBy":["hud/extensions/proposal-experience-registry.tsx","hud/panels/core/panel-body-registry.tsx","hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":11,"importedByCount":3,"externalImportCount":0},{"id":"hud/panels/organism/sections/OrganismPicker.tsx","zone":"hud","title":"OrganismPicker — inline dropdown for selecting an existing organism.","summary":"OrganismPicker — inline dropdown for selecting an existing organism.","intentHeader":"OrganismPicker — inline dropdown for selecting an existing organism.\n\nFetches paged organism search results from the API, filters out\nexcludeIds, and presents a clickable list. Used by the Composition\nsection to compose an existing organism into a parent.","internalImports":["api/organisms.ts"],"externalImports":["react"],"importedBy":["hud/panels/organism/sections/CompositionSection.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/organism/sections/ProposalsSection.tsx","zone":"hud","title":"ProposalsSection — displays and manages proposals for an organism.","summary":"ProposalsSection — displays and manages proposals for an organism.","intentHeader":"ProposalsSection — displays and manages proposals for an organism.\n\nLists open, integrated, and declined proposals with action buttons\nfor integrate/decline on open proposals.","internalImports":["api/organisms.ts","hooks/use-organism.ts","hud/panels/core/panel-ux.tsx","hud/panels/organism/sections/format-date.ts"],"externalImports":["react"],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":4,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/organism/sections/ProposeSection.tsx","zone":"hud","title":"ProposeSection — opens regulated proposals for an organism.","summary":"ProposeSection — opens regulated proposals for an organism.","intentHeader":"ProposeSection — opens regulated proposals for an organism.\n\nKeeps proposal creation separate from proposal integration so the\nregulated workflow has explicit, focused panel boundaries.","internalImports":["hooks/use-organism.ts","hud/panels/core/GuestAccessPrompt.tsx","hud/panels/core/panel-ux.tsx","hud/panels/forms/ProposeForm.tsx"],"externalImports":["react"],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":4,"importedByCount":1,"externalImportCount":1},{"id":"hud/panels/organism/sections/relationships-presenter.ts","zone":"hud","title":"Relationships presenter — pure formatting and ordering for relationship rows.","summary":"Relationships presenter — pure formatting and ordering for relationship rows.","intentHeader":"Relationships presenter — pure formatting and ordering for relationship rows.\n\nKeeps relationship rendering deterministic and testable outside React so the\nsection component can stay focused on data loading and layout.","internalImports":["api/types.ts"],"externalImports":[],"importedBy":["hud/panels/organism/sections/RelationshipsSection.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/organism/sections/RelationshipsSection.tsx","zone":"hud","title":"RelationshipsSection — read-only relationship visibility for an organism.","summary":"RelationshipsSection — read-only relationship visibility for an organism.","intentHeader":"RelationshipsSection — read-only relationship visibility for an organism.\n\nShows the connective tissue between users and the current organism so\nstewardship and integration authority remain legible while tending.","internalImports":["hooks/use-organism.ts","hud/panels/core/panel-ux.tsx","hud/panels/organism/sections/relationships-presenter.ts"],"externalImports":[],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":3,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/organism/sections/StateHistorySection.tsx","zone":"hud","title":"StateHistorySection — displays the state history of an organism.","summary":"StateHistorySection — displays the state history of an organism.","intentHeader":"StateHistorySection — displays the state history of an organism.\n\nShows each state's sequence number, content type, and creation date\nin reverse chronological order.","internalImports":["hooks/use-organism.ts","hud/panels/core/panel-ux.tsx","hud/panels/organism/sections/format-date.ts"],"externalImports":[],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":3,"importedByCount":1,"externalImportCount":0},{"id":"hud/panels/organism/sections/VitalitySection.tsx","zone":"hud","title":"VitalitySection — displays vitality indicators for an organism.","summary":"VitalitySection — displays vitality indicators for an organism.","intentHeader":"VitalitySection — displays vitality indicators for an organism.\n\nShows recent state changes, open proposal count, and last activity date.","internalImports":["hooks/use-organism.ts","hud/panels/organism/sections/format-date.ts"],"externalImports":[],"importedBy":["hud/panels/organism/sections/index.ts"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"hud/widgets/CompassWidget.tsx","zone":"hud","title":"CompassWidget — spatial orientation widget.","summary":"CompassWidget — spatial orientation widget.","intentHeader":"CompassWidget — spatial orientation widget.\n\nRendered in the adaptive widget lane for map context.","internalImports":[],"externalImports":[],"importedBy":["hud/widgets/index.ts"],"internalImportCount":0,"importedByCount":1,"externalImportCount":0},{"id":"hud/widgets/HistoryNavigationWidget.tsx","zone":"hud","title":"HistoryNavigationWidget — widget-lane navigation for main panel history.","summary":"HistoryNavigationWidget — widget-lane navigation for main panel history.","intentHeader":"HistoryNavigationWidget — widget-lane navigation for main panel history.\n\nPresents previous/next controls using the shared widget slot dimensions so\nhistory navigation aligns with the rest of the visor widget lane.","internalImports":[],"externalImports":[],"importedBy":["hud/widgets/index.ts"],"internalImportCount":0,"importedByCount":1,"externalImportCount":0},{"id":"hud/widgets/index.ts","zone":"hud","title":null,"summary":null,"intentHeader":null,"internalImports":["hud/widgets/CompassWidget.tsx","hud/widgets/HistoryNavigationWidget.tsx","hud/widgets/MapLegendWidget.tsx","hud/widgets/VisorWidgetLane.tsx","hud/widgets/VitalityWidget.tsx"],"externalImports":[],"importedBy":["hud/AdaptiveVisorHost.tsx","hud/panels/organism/OrganismPanelDeck.tsx"],"internalImportCount":5,"importedByCount":2,"externalImportCount":0},{"id":"hud/widgets/MapLegendWidget.tsx","zone":"hud","title":"MapLegendWidget - compact marker legend for spatial-map exploration.","summary":"MapLegendWidget - compact marker legend for spatial-map exploration.","intentHeader":"MapLegendWidget - compact marker legend for spatial-map exploration.\n\nMirrors the map marker language so custom marker distinctions for\ncontent types remain understandable while navigating the map.","internalImports":[],"externalImports":[],"importedBy":["hud/widgets/index.ts"],"internalImportCount":0,"importedByCount":1,"externalImportCount":0},{"id":"hud/widgets/VisorWidgetLane.tsx","zone":"hud","title":"VisorWidgetLane — shared lane for adaptive visor widgets.","summary":"VisorWidgetLane — shared lane for adaptive visor widgets.","intentHeader":"VisorWidgetLane — shared lane for adaptive visor widgets.\n\nWidgets are not panels. They are lightweight situational indicators\nrendered in a dedicated lane that can be gated by context and intent.","internalImports":[],"externalImports":["react"],"importedBy":["hud/widgets/index.ts"],"internalImportCount":0,"importedByCount":1,"externalImportCount":1},{"id":"hud/widgets/VitalityWidget.tsx","zone":"hud","title":"VitalityWidget — compact vitality summary for organism tending context.","summary":"VitalityWidget — compact vitality summary for organism tending context.","intentHeader":"VitalityWidget — compact vitality summary for organism tending context.\n\nSurfaces state-change/proposal signal in the widget lane while keeping\nvitality out of the main panel taxonomy.","internalImports":["hooks/use-organism.ts","hud/panels/organism/sections/format-date.ts"],"externalImports":[],"importedBy":["hud/widgets/index.ts"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"main.tsx","zone":"main.tsx","title":"Web entrypoint.","summary":"Web entrypoint.","intentHeader":"Web entrypoint.\n\nRegisters content-type renderers and mounts the root React app into\nthe browser document.","internalImports":["App.tsx","renderers/index.ts"],"externalImports":["react","react-dom/client"],"importedBy":[],"internalImportCount":2,"importedByCount":0,"externalImportCount":2},{"id":"platform/adaptive-visor-compositor.ts","zone":"platform","title":"Adaptive visor compositor — deterministic layout policy for visor surfaces.","summary":"Adaptive visor compositor — deterministic layout policy for visor surfaces.","intentHeader":"Adaptive visor compositor — deterministic layout policy for visor surfaces.\n\nReplaces mode-specific branching with a single policy graph that maps\nplatform context + intent + mutation events to the next visor layout.\nThis keeps behavior debuggable while supporting restore/recompute rules.","internalImports":["contracts/altitude.ts","contracts/visor-widget.ts"],"externalImports":[],"importedBy":["hud/AdaptiveVisorHost.tsx","hud/contracts/adaptive-visor-behavior-contract.ts","hud/Hud.tsx","platform/PlatformContext.tsx"],"internalImportCount":2,"importedByCount":4,"externalImportCount":0},{"id":"platform/adaptive-visor-feature-flag.ts","zone":"platform","title":"Adaptive visor diagnostics flag resolver.","summary":"Adaptive visor diagnostics flag resolver.","intentHeader":"Adaptive visor diagnostics flag resolver.\n\nAdaptive rendering is now always enabled. This resolver remains for\noptional trace logging during policy debugging.","internalImports":[],"externalImports":[],"importedBy":["platform/PlatformContext.tsx"],"internalImportCount":0,"importedByCount":1,"externalImportCount":0},{"id":"platform/index.ts","zone":"platform","title":null,"summary":null,"intentHeader":null,"internalImports":["platform/Platform.tsx","platform/PlatformContext.tsx"],"externalImports":[],"importedBy":["App.tsx","hud/AdaptiveVisorHost.tsx","hud/Hud.tsx","hud/panels/map/HudMyProposalsPanel.tsx","hud/panels/map/HudProfilePanel.tsx","hud/panels/organism/OrganismPanelDeck.tsx","hud/panels/organism/sections/ComponentsSection.tsx","hud/panels/organism/sections/CompositionSection.tsx","space/Space.tsx","space/SpaceNavBar.tsx"],"internalImportCount":2,"importedByCount":10,"externalImportCount":0},{"id":"platform/Platform.tsx","zone":"platform","title":"Platform — bootstrap component for the Space + HUD paradigm.","summary":"Platform — bootstrap component for the Space + HUD paradigm.","intentHeader":"Platform — bootstrap component for the Space + HUD paradigm.\n\nFetches the world map ID, then wraps Space and Hud in PlatformProvider.\nThis is the root of both guest read and authenticated tending flows.","internalImports":["api/organisms.ts","hud/index.ts","platform/PlatformContext.tsx","space/index.ts"],"externalImports":["react"],"importedBy":["platform/index.ts"],"internalImportCount":4,"importedByCount":1,"externalImportCount":1},{"id":"platform/PlatformContext.tsx","zone":"platform","title":"PlatformContext — shared state for the Space + HUD paradigm.","summary":"PlatformContext — shared state for the Space + HUD paradigm.","intentHeader":"PlatformContext — shared state for the Space + HUD paradigm.\n\nManages navigation (map stack), organism focus, visor targeting,\nand current altitude. All platform-level coordination flows\nthrough this context.","internalImports":["contracts/altitude.ts","platform/adaptive-visor-compositor.ts","platform/adaptive-visor-feature-flag.ts"],"externalImports":["react"],"importedBy":["platform/index.ts","platform/Platform.tsx"],"internalImportCount":3,"importedByCount":2,"externalImportCount":1},{"id":"renderers/audio.tsx","zone":"renderers","title":"Audio renderer — displays audio organism metadata.","summary":"Audio renderer — displays audio organism metadata.","intentHeader":"Audio renderer — displays audio organism metadata.\n\nShows title, artist, duration, format badge, and sample rate.\nFeels like a record sleeve — title prominent, metadata quiet.","internalImports":["api/files.ts","renderers/registry.ts"],"externalImports":[],"importedBy":["renderers/index.ts"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"renderers/community.tsx","zone":"renderers","title":"Community renderer — displays community description at Close altitude.","summary":"Community renderer — displays community description at Close altitude.","intentHeader":"Community renderer — displays community description at Close altitude.\n\nAt Mid altitude the type badge already shows \"community\". This renderer\nprovides the Close-altitude view with the community's description text.","internalImports":["renderers/registry.ts"],"externalImports":[],"importedBy":["renderers/index.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"renderers/composition-reference.tsx","zone":"renderers","title":"Composition reference renderer — tracklist display for composition organisms.","summary":"Composition reference renderer — tracklist display for composition organisms.","intentHeader":"Composition reference renderer — tracklist display for composition organisms.\n\nShows arrangement type, numbered entry list with truncated organism IDs,\nand entry count. Feels like a tracklist or table of contents.","internalImports":["renderers/registry.ts"],"externalImports":[],"importedBy":["renderers/index.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"renderers/daw-project.tsx","zone":"renderers","title":"DAW project renderer — metadata card for source production files.","summary":"DAW project renderer — metadata card for source production files.","intentHeader":"DAW project renderer — metadata card for source production files.\n\nKeeps source project context visible without exposing raw file internals.","internalImports":["renderers/registry.ts"],"externalImports":[],"importedBy":["renderers/index.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"renderers/fallback.tsx","zone":"renderers","title":"Fallback renderer — structured display for unknown content types.","summary":"Fallback renderer — structured display for unknown content types.","intentHeader":"Fallback renderer — structured display for unknown content types.\n\nShows the content type as a badge and iterates top-level payload\nkeys as labeled rows. Nested objects get a formatted pre block.","internalImports":["renderers/registry.ts"],"externalImports":[],"importedBy":["renderers/index.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"renderers/hero-journey-scene.tsx","zone":"renderers","title":"Hero Journey Scene renderer — cinematic narrative scroll experience.","summary":"Hero Journey Scene renderer — cinematic narrative scroll experience.","intentHeader":"Hero Journey Scene renderer — cinematic narrative scroll experience.\n\nThis renderer presents a stage-driven concept arc with synchronized motion.\nScroll progression advances stage focus, while a pinned cinematic core\nresponds to the active stage's signal.","internalImports":["hooks/use-organism.ts","renderers/registry.ts"],"externalImports":["gsap","gsap/ScrollTrigger","react"],"importedBy":["renderers/index.ts"],"internalImportCount":2,"importedByCount":1,"externalImportCount":3},{"id":"renderers/hero-journey-stage.tsx","zone":"renderers","title":"Hero Journey Stage renderer — focused stage narrative card.","summary":"Hero Journey Stage renderer — focused stage narrative card.","intentHeader":"Hero Journey Stage renderer — focused stage narrative card.","internalImports":["renderers/registry.ts"],"externalImports":["react"],"importedBy":["renderers/index.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":1},{"id":"renderers/image.tsx","zone":"renderers","title":"Image renderer — displays image organism metadata with placeholder frame.","summary":"Image renderer — displays image organism metadata with placeholder frame.","intentHeader":"Image renderer — displays image organism metadata with placeholder frame.\n\nShows title, an aspect-ratio placeholder rectangle (no actual image),\ndimensions, format badge, and optional location.","internalImports":["renderers/registry.ts"],"externalImports":[],"importedBy":["renderers/index.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"renderers/index.ts","zone":"renderers","title":"Renderer registration — registers all content-type renderers at startup.","summary":"Renderer registration — registers all content-type renderers at startup.","intentHeader":"Renderer registration — registers all content-type renderers at startup.","internalImports":["renderers/audio.tsx","renderers/community.tsx","renderers/composition-reference.tsx","renderers/daw-project.tsx","renderers/fallback.tsx","renderers/hero-journey-scene.tsx","renderers/hero-journey-stage.tsx","renderers/image.tsx","renderers/registry.ts","renderers/song.tsx","renderers/stems-bundle.tsx","renderers/text.tsx"],"externalImports":[],"importedBy":["hud/panels/organism/OrganismPanelDeck.tsx","main.tsx","space/OrganismInterior.tsx","space/SpaceOrganism.tsx"],"internalImportCount":12,"importedByCount":4,"externalImportCount":0},{"id":"renderers/registry.ts","zone":"renderers","title":"Renderer registry — maps content type IDs to React components.","summary":"Renderer registry — maps content type IDs to React components.","intentHeader":"Renderer registry — maps content type IDs to React components.\n\nThe rendering layer asks \"what content type is this state?\" and\nloads the appropriate renderer. Unknown types get a fallback.","internalImports":["api/types.ts"],"externalImports":["react"],"importedBy":["renderers/audio.tsx","renderers/community.tsx","renderers/composition-reference.tsx","renderers/daw-project.tsx","renderers/fallback.tsx","renderers/hero-journey-scene.tsx","renderers/hero-journey-stage.tsx","renderers/image.tsx","renderers/index.ts","renderers/song.tsx","renderers/stems-bundle.tsx","renderers/text.tsx"],"internalImportCount":1,"importedByCount":12,"externalImportCount":1},{"id":"renderers/song.tsx","zone":"renderers","title":"Song renderer — curated song experience assembled from composed children.","summary":"Song renderer — curated song experience assembled from composed children.","intentHeader":"Song renderer — curated song experience assembled from composed children.\n\nThe parent song state carries core identity; production assets and\nlistening variants are composed as child organisms inside the boundary.","internalImports":["api/files.ts","hooks/use-organism.ts","renderers/registry.ts"],"externalImports":[],"importedBy":["renderers/index.ts"],"internalImportCount":3,"importedByCount":1,"externalImportCount":0},{"id":"renderers/stems-bundle.tsx","zone":"renderers","title":"Stems bundle renderer — metadata card for exported stems packages.","summary":"Stems bundle renderer — metadata card for exported stems packages.","intentHeader":"Stems bundle renderer — metadata card for exported stems packages.\n\nPresents delivery-oriented details while keeping stems as a first-class\norganism within the song boundary.","internalImports":["renderers/registry.ts"],"externalImports":[],"importedBy":["renderers/index.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"renderers/text.tsx","zone":"renderers","title":"Text renderer — displays text/markdown content.","summary":"Text renderer — displays text/markdown content.","intentHeader":"Text renderer — displays text/markdown content.\n\nHandles plaintext as paragraphs and markdown with a lightweight\nparser covering headings and blank-line-separated paragraphs.\nLine breaks within paragraphs are preserved (for poetry stanzas).","internalImports":["renderers/registry.ts"],"externalImports":["react"],"importedBy":["renderers/index.ts"],"internalImportCount":1,"importedByCount":1,"externalImportCount":1},{"id":"space/AltitudeControls.tsx","zone":"space","title":"AltitudeControls — fixed-position HUD for altitude navigation.","summary":"AltitudeControls — fixed-position HUD for altitude navigation.","intentHeader":"AltitudeControls — fixed-position HUD for altitude navigation.\n\nShows +/- buttons with the current altitude level label between them.\nPositioned bottom-right. Provides clear visual feedback about which\ndiscrete altitude level the viewport is at.","internalImports":["contracts/altitude.ts"],"externalImports":[],"importedBy":["space/Space.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"space/ambient/space-ambient-layer-contract.ts","zone":"space","title":"Space ambient layer contract — canonical world overlays rendered inside Space.","summary":"Space ambient layer contract — canonical world overlays rendered inside Space.","intentHeader":"Space ambient layer contract — canonical world overlays rendered inside Space.\n\nAmbient layers represent conditions that are happening in Space itself\n(for example weather or field intensity), not visor interpretation modes.","internalImports":["contracts/altitude.ts","space/use-spatial-map.ts","space/viewport-math.ts"],"externalImports":["react"],"importedBy":["space/ambient/space-ambient-layer-registry.ts","space/ambient/SpaceAmbientLayerHost.tsx","space/index.ts"],"internalImportCount":3,"importedByCount":3,"externalImportCount":1},{"id":"space/ambient/space-ambient-layer-registry.ts","zone":"space","title":"Space ambient layer registry — ordered registration for canonical Space overlays.","summary":"Space ambient layer registry — ordered registration for canonical Space overlays.","intentHeader":"Space ambient layer registry — ordered registration for canonical Space overlays.\n\nKeeps ambient layer composition deterministic so additional world conditions\ncan be introduced without changing the Space root renderer.","internalImports":["space/ambient/space-ambient-layer-contract.ts"],"externalImports":[],"importedBy":["space/ambient/SpaceAmbientLayerHost.tsx","space/index.ts"],"internalImportCount":1,"importedByCount":2,"externalImportCount":0},{"id":"space/ambient/SpaceAmbientLayerHost.tsx","zone":"space","title":"SpaceAmbientLayerHost — renders registered canonical ambient Space layers.","summary":"SpaceAmbientLayerHost — renders registered canonical ambient Space layers.","intentHeader":"SpaceAmbientLayerHost — renders registered canonical ambient Space layers.\n\nThis host is intentionally passive: it only gathers context and renders\nregistered layers in deterministic order.","internalImports":["space/ambient/space-ambient-layer-contract.ts","space/ambient/space-ambient-layer-registry.ts"],"externalImports":[],"importedBy":["space/Space.tsx"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"space/GroundPlane.tsx","zone":"space","title":"GroundPlane — CSS grid background rendered in world space behind organisms.","summary":"GroundPlane — CSS grid background rendered in world space behind organisms.","intentHeader":"GroundPlane — CSS grid background rendered in world space behind organisms.\n\nUses CSS background-image gradients for the grid — GPU-composited,\nno flashing or subpixel artifacts during pan/zoom animation.\nOpacity responds to altitude: prominent at High, subtle at Close.\nPointer events are disabled so it never interferes with pan/click.","internalImports":["contracts/altitude.ts"],"externalImports":[],"importedBy":["space/Space.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":0},{"id":"space/index.ts","zone":"space","title":null,"summary":null,"intentHeader":null,"internalImports":["space/ambient/space-ambient-layer-contract.ts","space/ambient/space-ambient-layer-registry.ts","space/Space.tsx","space/SpaceNavBar.tsx"],"externalImports":[],"importedBy":["platform/Platform.tsx"],"internalImportCount":4,"importedByCount":1,"externalImportCount":0},{"id":"space/OrganismInterior.tsx","zone":"space","title":"OrganismInterior — full-screen content-type renderer for an entered organism.","summary":"OrganismInterior — full-screen content-type renderer for an entered organism.","intentHeader":"OrganismInterior — full-screen content-type renderer for an entered organism.\n\nDisplayed when the user has zoomed into an organism's interior.\nReceives an opacity prop for crossfade transitions. Looks up the\nappropriate content-type renderer, falling back to FallbackRenderer.","internalImports":["hooks/use-organism.ts","renderers/index.ts"],"externalImports":[],"importedBy":["space/Space.tsx"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"space/Space.tsx","zone":"space","title":"Space — the 2D zoomable canvas where organisms are experienced.","summary":"Space — the 2D zoomable canvas where organisms are experienced.","intentHeader":"Space — the 2D zoomable canvas where organisms are experienced.\n\nOrchestrates the spatial-map data, viewport state with discrete\naltitude levels, and rendering layers. Manages transitions between\nmap exploration and organism interiors via a phase state machine:\nmap → entering → inside → exiting → map.","internalImports":["platform/index.ts","space/AltitudeControls.tsx","space/ambient/SpaceAmbientLayerHost.tsx","space/GroundPlane.tsx","space/OrganismInterior.tsx","space/SpaceLayer.tsx","space/SpaceViewport.tsx","space/use-space-phase-machine.ts","space/use-spatial-map.ts","space/use-viewport.ts","space/viewport-math.ts"],"externalImports":["react"],"importedBy":["space/index.ts"],"internalImportCount":11,"importedByCount":1,"externalImportCount":1},{"id":"space/SpaceLayer.tsx","zone":"space","title":"SpaceLayer — renders all visible organisms in the current map.","summary":"SpaceLayer — renders all visible organisms in the current map.","intentHeader":"SpaceLayer — renders all visible organisms in the current map.\n\nComputes visible bounds from the viewport and filters entries to only\nthose in view (with margin). Delegates each to SpaceOrganism.\nPasses the current altitude for altitude-responsive rendering.","internalImports":["contracts/altitude.ts","hooks/use-organism.ts","space/SpaceOrganism.tsx","space/use-spatial-map.ts","space/viewport-math.ts"],"externalImports":["react"],"importedBy":["space/Space.tsx"],"internalImportCount":5,"importedByCount":1,"externalImportCount":1},{"id":"space/SpaceNavBar.tsx","zone":"space","title":"SpaceNavBar — persistent top navigation for spatial movement.","summary":"SpaceNavBar — persistent top navigation for spatial movement.","intentHeader":"SpaceNavBar — persistent top navigation for spatial movement.\n\nDisplays current location context and a physical back cascade across\nvisor focus, interior presence, focused organism, and map stack.","internalImports":["hooks/use-organism.ts","platform/index.ts"],"externalImports":[],"importedBy":["space/index.ts"],"internalImportCount":2,"importedByCount":1,"externalImportCount":0},{"id":"space/SpaceOrganism.tsx","zone":"space","title":"SpaceOrganism — renders a single organism at its world position.","summary":"SpaceOrganism — renders a single organism at its world position.","intentHeader":"SpaceOrganism — renders a single organism at its world position.\n\nPositioned absolutely in world-space coordinates. Renders differently\nat each altitude: dot at High, badge + label at Mid, full content-type\nrenderer at Close. Handles click (focus + animate to Close) and\ndouble-click (enter map for spatial-map organisms).","internalImports":["contracts/altitude.ts","hooks/use-organism.ts","renderers/index.ts","space/use-spatial-map.ts","space/viewport-math.ts"],"externalImports":["react"],"importedBy":["space/SpaceLayer.tsx"],"internalImportCount":5,"importedByCount":1,"externalImportCount":1},{"id":"space/SpaceViewport.tsx","zone":"space","title":"SpaceViewport — CSS transform container with pan and altitude event handling.","summary":"SpaceViewport — CSS transform container with pan and altitude event handling.","intentHeader":"SpaceViewport — CSS transform container with pan and altitude event handling.\n\nHandles single-pointer pan, two-finger pinch (pan + accumulated altitude change),\nscroll wheel (accumulated altitude change), and keyboard shortcuts (+/-).\nApplies CSS transforms for GPU-accelerated rendering.","internalImports":["space/viewport-math.ts"],"externalImports":["react"],"importedBy":["space/Space.tsx"],"internalImportCount":1,"importedByCount":1,"externalImportCount":1},{"id":"space/use-space-phase-machine.ts","zone":"space","title":"useSpacePhaseMachine — transition policy for map/interior movement.","summary":"useSpacePhaseMachine — transition policy for map/interior movement.","intentHeader":"useSpacePhaseMachine — transition policy for map/interior movement.\n\nEncapsulates Space's phase state machine and interior fade choreography\nso Space rendering can stay focused on composition and viewport wiring.","internalImports":["space/use-spatial-map.ts","space/viewport-math.ts"],"externalImports":["react"],"importedBy":["space/Space.tsx"],"internalImportCount":2,"importedByCount":1,"externalImportCount":1},{"id":"space/use-spatial-map.ts","zone":"space","title":"useSpatialMap — loads and parses a spatial-map organism.","summary":"useSpatialMap — loads and parses a spatial-map organism.","intentHeader":"useSpatialMap — loads and parses a spatial-map organism.\n\nReuses useOrganism for fetching, then extracts the entries array\nfrom the spatial-map payload. Filters to valid entries that have\nthe required organismId, x, and y fields.","internalImports":["hooks/use-organism.ts"],"externalImports":[],"importedBy":["space/ambient/space-ambient-layer-contract.ts","space/Space.tsx","space/SpaceLayer.tsx","space/SpaceOrganism.tsx","space/use-space-phase-machine.ts"],"internalImportCount":1,"importedByCount":5,"externalImportCount":0},{"id":"space/use-viewport.ts","zone":"space","title":"useViewport — manages pan/zoom viewport state for the 2D canvas.","summary":"useViewport — manages pan/zoom viewport state for the 2D canvas.","intentHeader":"useViewport — manages pan/zoom viewport state for the 2D canvas.\n\nTracks screen size via ResizeObserver and provides viewport state\nwith a setter. Derives altitude from zoom and provides changeAltitude\nfor discrete altitude transitions. Clamps viewport to map bounds.\nResets to High altitude centered view when map dimensions change.","internalImports":["contracts/altitude.ts","space/viewport-math.ts"],"externalImports":["react"],"importedBy":["space/Space.tsx"],"internalImportCount":2,"importedByCount":1,"externalImportCount":1},{"id":"space/viewport-math.ts","zone":"space","title":"Viewport math — pure functions for 2D canvas coordinate transforms.","summary":"Viewport math — pure functions for 2D canvas coordinate transforms.","intentHeader":"Viewport math — pure functions for 2D canvas coordinate transforms.\n\nNo React, no side effects. All coordinate math for the pan/zoom\ncanvas lives here so it can be tested independently.\n\nThe altitude system provides three discrete zoom levels that the\nviewport snaps between, replacing continuous zoom.","internalImports":["contracts/altitude.ts"],"externalImports":[],"importedBy":["space/ambient/space-ambient-layer-contract.ts","space/Space.tsx","space/SpaceLayer.tsx","space/SpaceOrganism.tsx","space/SpaceViewport.tsx","space/use-space-phase-machine.ts","space/use-viewport.ts"],"internalImportCount":1,"importedByCount":7,"externalImportCount":0}],"edges":[{"source":"App.tsx","target":"api/auth.ts"},{"source":"App.tsx","target":"auth/AuthDialog.tsx"},{"source":"App.tsx","target":"auth/auth-request.ts"},{"source":"App.tsx","target":"auth/session.ts"},{"source":"App.tsx","target":"config/runtime-flags.ts"},{"source":"App.tsx","target":"hooks/use-organism.ts"},{"source":"App.tsx","target":"hud/panels/core/AdaptiveVisorHarness.tsx"},{"source":"App.tsx","target":"platform/index.ts"},{"source":"api/auth.ts","target":"api/client.ts"},{"source":"api/interest.ts","target":"api/client.ts"},{"source":"api/organisms.ts","target":"api/client.ts"},{"source":"api/organisms.ts","target":"api/types.ts"},{"source":"api/surface.ts","target":"api/client.ts"},{"source":"api/surface.ts","target":"api/organisms.ts"},{"source":"auth/AuthDialog.tsx","target":"api/auth.ts"},{"source":"auth/AuthDialog.tsx","target":"auth/session.ts"},{"source":"contracts/index.ts","target":"contracts/altitude.ts"},{"source":"contracts/index.ts","target":"contracts/visor-widget.ts"},{"source":"hooks/use-is-surfaced.ts","target":"hooks/use-organism.ts"},{"source":"hooks/use-organism.ts","target":"api/client.ts"},{"source":"hooks/use-organism.ts","target":"api/organisms.ts"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hooks/use-organism.ts"},{"source":"hud/AdaptiveVisorHost.tsx","target":"platform/adaptive-visor-compositor.ts"},{"source":"hud/AdaptiveVisorHost.tsx","target":"platform/index.ts"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hud/panels/core/panel-body-registry.tsx"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hud/panels/core/panel-layout-policy.ts"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hud/panels/core/template-schema.ts"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hud/panels/core/use-main-panel-history-navigation.ts"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hud/panels/core/VisorPanelDeck.tsx"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hud/panels/organism/OrganismPanelDeck.tsx"},{"source":"hud/AdaptiveVisorHost.tsx","target":"hud/widgets/index.ts"},{"source":"hud/Hud.tsx","target":"platform/adaptive-visor-compositor.ts"},{"source":"hud/Hud.tsx","target":"platform/index.ts"},{"source":"hud/Hud.tsx","target":"hud/AdaptiveVisorHost.tsx"},{"source":"hud/Hud.tsx","target":"hud/cues/HudCueLayer.tsx"},{"source":"hud/contracts/adaptive-visor-behavior-contract.ts","target":"contracts/visor-widget.ts"},{"source":"hud/contracts/adaptive-visor-behavior-contract.ts","target":"platform/adaptive-visor-compositor.ts"},{"source":"hud/contracts/adaptive-visor-behavior-contract.ts","target":"hud/cues/cue-schema.ts"},{"source":"hud/contracts/adaptive-visor-behavior-contract.ts","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/cues/HudCueLayer.tsx","target":"hud/cues/cue-placement.ts"},{"source":"hud/cues/HudCueLayer.tsx","target":"hud/cues/cue-policy.ts"},{"source":"hud/cues/HudCueLayer.tsx","target":"hud/cues/cue-schema.ts"},{"source":"hud/cues/cue-policy.ts","target":"hud/cues/cue-schema.ts"},{"source":"hud/extensions/proposal-experience-registry.tsx","target":"hud/panels/organism/sections/index.ts"},{"source":"hud/index.ts","target":"hud/Hud.tsx"},{"source":"hud/panels/core/AdaptiveVisorHarness.tsx","target":"hud/panels/core/panel-layout-policy.ts"},{"source":"hud/panels/core/AdaptiveVisorHarness.tsx","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/panels/core/AdaptiveVisorHarness.tsx","target":"hud/panels/core/template-schema.ts"},{"source":"hud/panels/core/AdaptiveVisorHarness.tsx","target":"hud/panels/core/VisorPanelDeck.tsx"},{"source":"hud/panels/core/GuestAccessPrompt.tsx","target":"api/interest.ts"},{"source":"hud/panels/core/GuestAccessPrompt.tsx","target":"auth/auth-request.ts"},{"source":"hud/panels/core/GuestAccessPrompt.tsx","target":"config/runtime-flags.ts"},{"source":"hud/panels/core/GuestAccessPrompt.tsx","target":"hud/panels/core/RegisterInterestForm.tsx"},{"source":"hud/panels/core/RegisterInterestForm.tsx","target":"api/interest.ts"},{"source":"hud/panels/core/VisorPanelDeck.tsx","target":"hud/panels/core/panel-layout-policy.ts"},{"source":"hud/panels/core/VisorPanelDeck.tsx","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/panels/core/VisorPanelDeck.tsx","target":"hud/panels/core/template-schema.ts"},{"source":"hud/panels/core/intent-matrix.ts","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/panels/core/panel-body-registry.tsx","target":"hud/extensions/proposal-experience-registry.tsx"},{"source":"hud/panels/core/panel-body-registry.tsx","target":"hud/panels/map/HudMyProposalsPanel.tsx"},{"source":"hud/panels/core/panel-body-registry.tsx","target":"hud/panels/map/HudProfilePanel.tsx"},{"source":"hud/panels/core/panel-body-registry.tsx","target":"hud/panels/organism/sections/index.ts"},{"source":"hud/panels/core/panel-body-registry.tsx","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/panels/core/panel-layout-policy.ts","target":"hud/panels/core/intent-matrix.ts"},{"source":"hud/panels/core/panel-layout-policy.ts","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/panels/core/panel-layout-policy.ts","target":"hud/panels/core/template-schema.ts"},{"source":"hud/panels/core/template-schema.ts","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/panels/core/template-schema.ts","target":"hud/panels/core/widget-schema.ts"},{"source":"hud/panels/core/use-main-panel-history-navigation.ts","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/panels/core/widget-schema.ts","target":"contracts/visor-widget.ts"},{"source":"hud/panels/forms/ProposeForm.tsx","target":"api/organisms.ts"},{"source":"hud/panels/forms/ThresholdForm.tsx","target":"api/organisms.ts"},{"source":"hud/panels/map/HudMyProposalsPanel.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/map/HudMyProposalsPanel.tsx","target":"platform/index.ts"},{"source":"hud/panels/map/HudMyProposalsPanel.tsx","target":"hud/panels/core/GuestAccessPrompt.tsx"},{"source":"hud/panels/map/HudMyProposalsPanel.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/map/HudMyProposalsPanel.tsx","target":"hud/panels/organism/sections/format-date.ts"},{"source":"hud/panels/map/HudMyProposalsPanel.tsx","target":"hud/panels/map/my-proposals-presenter.ts"},{"source":"hud/panels/map/HudProfilePanel.tsx","target":"platform/index.ts"},{"source":"hud/panels/map/HudProfilePanel.tsx","target":"hud/panels/core/GuestAccessPrompt.tsx"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"api/surface.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hooks/use-is-surfaced.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"platform/index.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"renderers/index.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hud/widgets/index.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hud/panels/core/panel-body-registry.tsx"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hud/panels/core/panel-layout-policy.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hud/panels/core/panel-schema.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hud/panels/core/template-schema.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hud/panels/core/use-main-panel-history-navigation.ts"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hud/panels/core/VisorPanelDeck.tsx"},{"source":"hud/panels/organism/OrganismPanelDeck.tsx","target":"hud/panels/organism/sections/index.ts"},{"source":"hud/panels/organism/sections/AppendSection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/AppendSection.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/organism/sections/AppendSection.tsx","target":"hud/panels/forms/ProposeForm.tsx"},{"source":"hud/panels/organism/sections/ComponentsSection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/ComponentsSection.tsx","target":"platform/index.ts"},{"source":"hud/panels/organism/sections/ComponentsSection.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/organism/sections/CompositionSection.tsx","target":"api/organisms.ts"},{"source":"hud/panels/organism/sections/CompositionSection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/CompositionSection.tsx","target":"platform/index.ts"},{"source":"hud/panels/organism/sections/CompositionSection.tsx","target":"hud/panels/forms/ThresholdForm.tsx"},{"source":"hud/panels/organism/sections/CompositionSection.tsx","target":"hud/panels/organism/sections/OrganismPicker.tsx"},{"source":"hud/panels/organism/sections/ContributionsSection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/ContributionsSection.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/organism/sections/ContributionsSection.tsx","target":"hud/panels/organism/sections/format-date.ts"},{"source":"hud/panels/organism/sections/GovernanceSection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/GovernanceSection.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/organism/sections/OrganismPicker.tsx","target":"api/organisms.ts"},{"source":"hud/panels/organism/sections/ProposalsSection.tsx","target":"api/organisms.ts"},{"source":"hud/panels/organism/sections/ProposalsSection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/ProposalsSection.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/organism/sections/ProposalsSection.tsx","target":"hud/panels/organism/sections/format-date.ts"},{"source":"hud/panels/organism/sections/ProposeSection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/ProposeSection.tsx","target":"hud/panels/core/GuestAccessPrompt.tsx"},{"source":"hud/panels/organism/sections/ProposeSection.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/organism/sections/ProposeSection.tsx","target":"hud/panels/forms/ProposeForm.tsx"},{"source":"hud/panels/organism/sections/RelationshipsSection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/RelationshipsSection.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/organism/sections/RelationshipsSection.tsx","target":"hud/panels/organism/sections/relationships-presenter.ts"},{"source":"hud/panels/organism/sections/StateHistorySection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/StateHistorySection.tsx","target":"hud/panels/core/panel-ux.tsx"},{"source":"hud/panels/organism/sections/StateHistorySection.tsx","target":"hud/panels/organism/sections/format-date.ts"},{"source":"hud/panels/organism/sections/VitalitySection.tsx","target":"hooks/use-organism.ts"},{"source":"hud/panels/organism/sections/VitalitySection.tsx","target":"hud/panels/organism/sections/format-date.ts"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/AppendSection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/ComponentsSection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/CompositionSection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/ContributionsSection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/format-date.ts"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/GovernanceSection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/ProposalsSection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/ProposeSection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/RelationshipsSection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/StateHistorySection.tsx"},{"source":"hud/panels/organism/sections/index.ts","target":"hud/panels/organism/sections/VitalitySection.tsx"},{"source":"hud/panels/organism/sections/relationships-presenter.ts","target":"api/types.ts"},{"source":"hud/widgets/VitalityWidget.tsx","target":"hooks/use-organism.ts"},{"source":"hud/widgets/VitalityWidget.tsx","target":"hud/panels/organism/sections/format-date.ts"},{"source":"hud/widgets/index.ts","target":"hud/widgets/CompassWidget.tsx"},{"source":"hud/widgets/index.ts","target":"hud/widgets/HistoryNavigationWidget.tsx"},{"source":"hud/widgets/index.ts","target":"hud/widgets/MapLegendWidget.tsx"},{"source":"hud/widgets/index.ts","target":"hud/widgets/VisorWidgetLane.tsx"},{"source":"hud/widgets/index.ts","target":"hud/widgets/VitalityWidget.tsx"},{"source":"main.tsx","target":"App.tsx"},{"source":"main.tsx","target":"renderers/index.ts"},{"source":"platform/Platform.tsx","target":"api/organisms.ts"},{"source":"platform/Platform.tsx","target":"hud/index.ts"},{"source":"platform/Platform.tsx","target":"space/index.ts"},{"source":"platform/Platform.tsx","target":"platform/PlatformContext.tsx"},{"source":"platform/PlatformContext.tsx","target":"contracts/altitude.ts"},{"source":"platform/PlatformContext.tsx","target":"platform/adaptive-visor-compositor.ts"},{"source":"platform/PlatformContext.tsx","target":"platform/adaptive-visor-feature-flag.ts"},{"source":"platform/adaptive-visor-compositor.ts","target":"contracts/altitude.ts"},{"source":"platform/adaptive-visor-compositor.ts","target":"contracts/visor-widget.ts"},{"source":"platform/index.ts","target":"platform/Platform.tsx"},{"source":"platform/index.ts","target":"platform/PlatformContext.tsx"},{"source":"renderers/audio.tsx","target":"api/files.ts"},{"source":"renderers/audio.tsx","target":"renderers/registry.ts"},{"source":"renderers/community.tsx","target":"renderers/registry.ts"},{"source":"renderers/composition-reference.tsx","target":"renderers/registry.ts"},{"source":"renderers/daw-project.tsx","target":"renderers/registry.ts"},{"source":"renderers/fallback.tsx","target":"renderers/registry.ts"},{"source":"renderers/hero-journey-scene.tsx","target":"hooks/use-organism.ts"},{"source":"renderers/hero-journey-scene.tsx","target":"renderers/registry.ts"},{"source":"renderers/hero-journey-stage.tsx","target":"renderers/registry.ts"},{"source":"renderers/image.tsx","target":"renderers/registry.ts"},{"source":"renderers/index.ts","target":"renderers/fallback.tsx"},{"source":"renderers/index.ts","target":"renderers/registry.ts"},{"source":"renderers/index.ts","target":"renderers/audio.tsx"},{"source":"renderers/index.ts","target":"renderers/community.tsx"},{"source":"renderers/index.ts","target":"renderers/composition-reference.tsx"},{"source":"renderers/index.ts","target":"renderers/daw-project.tsx"},{"source":"renderers/index.ts","target":"renderers/hero-journey-scene.tsx"},{"source":"renderers/index.ts","target":"renderers/hero-journey-stage.tsx"},{"source":"renderers/index.ts","target":"renderers/image.tsx"},{"source":"renderers/index.ts","target":"renderers/song.tsx"},{"source":"renderers/index.ts","target":"renderers/stems-bundle.tsx"},{"source":"renderers/index.ts","target":"renderers/text.tsx"},{"source":"renderers/registry.ts","target":"api/types.ts"},{"source":"renderers/song.tsx","target":"api/files.ts"},{"source":"renderers/song.tsx","target":"hooks/use-organism.ts"},{"source":"renderers/song.tsx","target":"renderers/registry.ts"},{"source":"renderers/stems-bundle.tsx","target":"renderers/registry.ts"},{"source":"renderers/text.tsx","target":"renderers/registry.ts"},{"source":"space/AltitudeControls.tsx","target":"contracts/altitude.ts"},{"source":"space/GroundPlane.tsx","target":"contracts/altitude.ts"},{"source":"space/OrganismInterior.tsx","target":"hooks/use-organism.ts"},{"source":"space/OrganismInterior.tsx","target":"renderers/index.ts"},{"source":"space/Space.tsx","target":"platform/index.ts"},{"source":"space/Space.tsx","target":"space/AltitudeControls.tsx"},{"source":"space/Space.tsx","target":"space/ambient/SpaceAmbientLayerHost.tsx"},{"source":"space/Space.tsx","target":"space/GroundPlane.tsx"},{"source":"space/Space.tsx","target":"space/OrganismInterior.tsx"},{"source":"space/Space.tsx","target":"space/SpaceLayer.tsx"},{"source":"space/Space.tsx","target":"space/SpaceViewport.tsx"},{"source":"space/Space.tsx","target":"space/use-space-phase-machine.ts"},{"source":"space/Space.tsx","target":"space/use-spatial-map.ts"},{"source":"space/Space.tsx","target":"space/use-viewport.ts"},{"source":"space/Space.tsx","target":"space/viewport-math.ts"},{"source":"space/SpaceLayer.tsx","target":"contracts/altitude.ts"},{"source":"space/SpaceLayer.tsx","target":"hooks/use-organism.ts"},{"source":"space/SpaceLayer.tsx","target":"space/SpaceOrganism.tsx"},{"source":"space/SpaceLayer.tsx","target":"space/use-spatial-map.ts"},{"source":"space/SpaceLayer.tsx","target":"space/viewport-math.ts"},{"source":"space/SpaceNavBar.tsx","target":"hooks/use-organism.ts"},{"source":"space/SpaceNavBar.tsx","target":"platform/index.ts"},{"source":"space/SpaceOrganism.tsx","target":"contracts/altitude.ts"},{"source":"space/SpaceOrganism.tsx","target":"hooks/use-organism.ts"},{"source":"space/SpaceOrganism.tsx","target":"renderers/index.ts"},{"source":"space/SpaceOrganism.tsx","target":"space/use-spatial-map.ts"},{"source":"space/SpaceOrganism.tsx","target":"space/viewport-math.ts"},{"source":"space/SpaceViewport.tsx","target":"space/viewport-math.ts"},{"source":"space/ambient/SpaceAmbientLayerHost.tsx","target":"space/ambient/space-ambient-layer-contract.ts"},{"source":"space/ambient/SpaceAmbientLayerHost.tsx","target":"space/ambient/space-ambient-layer-registry.ts"},{"source":"space/ambient/space-ambient-layer-contract.ts","target":"contracts/altitude.ts"},{"source":"space/ambient/space-ambient-layer-contract.ts","target":"space/use-spatial-map.ts"},{"source":"space/ambient/space-ambient-layer-contract.ts","target":"space/viewport-math.ts"},{"source":"space/ambient/space-ambient-layer-registry.ts","target":"space/ambient/space-ambient-layer-contract.ts"},{"source":"space/index.ts","target":"space/ambient/space-ambient-layer-contract.ts"},{"source":"space/index.ts","target":"space/ambient/space-ambient-layer-registry.ts"},{"source":"space/index.ts","target":"space/Space.tsx"},{"source":"space/index.ts","target":"space/SpaceNavBar.tsx"},{"source":"space/use-space-phase-machine.ts","target":"space/use-spatial-map.ts"},{"source":"space/use-space-phase-machine.ts","target":"space/viewport-math.ts"},{"source":"space/use-spatial-map.ts","target":"hooks/use-organism.ts"},{"source":"space/use-viewport.ts","target":"contracts/altitude.ts"},{"source":"space/use-viewport.ts","target":"space/viewport-math.ts"},{"source":"space/viewport-math.ts","target":"contracts/altitude.ts"}]};

      const graphSvg = document.getElementById('graphSvg');
      const searchInput = document.getElementById('searchInput');
      const zoneFilter = document.getElementById('zoneFilter');
      const nodeList = document.getElementById('nodeList');
      const details = document.getElementById('details');
      const generatedAt = document.getElementById('generatedAt');
      const visibleCount = document.getElementById('visibleCount');
      const summary = document.getElementById('summary');
      const zoneEdgeRows = document.getElementById('zoneEdgeRows');
      const clearFilters = document.getElementById('clearFilters');

      const zonePalette = [
        '#1f6feb', '#e67e22', '#2e9d72', '#c0392b', '#8e44ad', '#0f9ac8', '#c27c0e', '#5f7f98', '#2f5a3d',
      ];

      const zoneColorById = new Map();
      DATA.zones.forEach((zoneRecord, index) => {
        zoneColorById.set(zoneRecord.zone, zonePalette[index % zonePalette.length]);
      });

      const nodeById = new Map(DATA.nodes.map((node) => [node.id, node]));
      let selectedNodeId = DATA.nodes[0]?.id ?? null;

      function fillSummary() {
        generatedAt.textContent = DATA.generatedAt;
        const chips = [
          ['files', DATA.summary.fileCount],
          ['edges', DATA.summary.edgeCount],
          ['zones', DATA.summary.zoneCount],
          ['external imports', DATA.summary.externalImportCount],
        ];
        summary.innerHTML = chips.map(([label, value]) => '<span class="chip"><strong>' + value + '</strong> ' + label + '</span>').join('');
      }

      function fillZoneFilter() {
        const options = ['<option value="">All zones</option>']
          .concat(DATA.zones.map((zoneRecord) => '<option value="' + zoneRecord.zone + '">' + zoneRecord.zone + ' (' + zoneRecord.fileCount + ')</option>'));
        zoneFilter.innerHTML = options.join('');
      }

      function matchesFilter(node, search, zone) {
        const searchValue = search.trim().toLowerCase();
        const zoneMatches = !zone || node.zone === zone;
        if (!zoneMatches) return false;
        if (!searchValue) return true;

        const haystack = [
          node.id,
          node.zone,
          node.title || '',
          node.summary || '',
          node.intentHeader || '',
          node.internalImports.join(' '),
          node.importedBy.join(' '),
          node.externalImports.join(' '),
        ].join('\n').toLowerCase();

        return haystack.includes(searchValue);
      }

      function getVisibleNodes() {
        const zone = zoneFilter.value;
        const search = searchInput.value;
        return DATA.nodes.filter((node) => matchesFilter(node, search, zone));
      }

      function ensureSelectedNode(visibleNodes) {
        if (selectedNodeId && visibleNodes.some((node) => node.id === selectedNodeId)) return;
        selectedNodeId = visibleNodes[0]?.id ?? null;
      }

      function renderNodeList(visibleNodes) {
        visibleCount.textContent = 'Showing ' + visibleNodes.length + ' of ' + DATA.nodes.length + ' files';
        nodeList.innerHTML = visibleNodes
          .map((node) => {
            const activeClass = node.id === selectedNodeId ? ' active' : '';
            return (
              '<li><button class="list-item' + activeClass + '" data-node-id="' + node.id + '">' +
                '<span class="node-path">' + node.id + '</span>' +
                '<span class="node-meta">' + node.zone + ' | out ' + node.internalImportCount + ' | in ' + node.importedByCount + '</span>' +
              '</button></li>'
            );
          })
          .join('');

        nodeList.querySelectorAll('button[data-node-id]').forEach((button) => {
          button.addEventListener('click', () => {
            selectedNodeId = button.getAttribute('data-node-id');
            rerender();
          });
        });
      }

      function renderDetails(node) {
        if (!node) {
          details.innerHTML = '<div class="meta">No module selected.</div>';
          return;
        }

        const intentText = node.intentHeader || 'No intent header found.';
        const imports = node.internalImports.map((item) => '<li>' + item + '</li>').join('') || '<li>none</li>';
        const importedBy = node.importedBy.map((item) => '<li>' + item + '</li>').join('') || '<li>none</li>';
        const external = node.externalImports.map((item) => '<li>' + item + '</li>').join('') || '<li>none</li>';

        details.innerHTML =
          '<div><strong>' + node.id + '</strong></div>' +
          '<div class="meta">zone: ' + node.zone + ' | out: ' + node.internalImportCount + ' | in: ' + node.importedByCount + '</div>' +
          '<h3>Intent Header</h3><pre>' + intentText + '</pre>' +
          '<h3>Internal Imports</h3><ul class="detail-list">' + imports + '</ul>' +
          '<h3>Imported By</h3><ul class="detail-list">' + importedBy + '</ul>' +
          '<h3>External Imports</h3><ul class="detail-list">' + external + '</ul>';
      }

      function renderZoneEdges() {
        zoneEdgeRows.innerHTML = DATA.zoneEdges
          .map((row) => '<tr><td>' + row.sourceZone + '</td><td>' + row.targetZone + '</td><td>' + row.count + '</td></tr>')
          .join('');
      }

      function renderGraph(visibleNodes) {
        const visibleNodeIds = new Set(visibleNodes.map((node) => node.id));
        const visibleEdges = DATA.edges.filter((edge) => visibleNodeIds.has(edge.source) && visibleNodeIds.has(edge.target));

        const zoneOrder = Array.from(new Set(visibleNodes.map((node) => node.zone))).sort((a, b) => a.localeCompare(b));
        const nodesByZone = new Map(zoneOrder.map((zone) => [zone, []]));
        visibleNodes.forEach((node) => nodesByZone.get(node.zone).push(node));
        zoneOrder.forEach((zone) => nodesByZone.get(zone).sort((a, b) => a.id.localeCompare(b.id)));

        const maxZoneSize = Math.max(1, ...Array.from(nodesByZone.values()).map((nodes) => nodes.length));
        const width = Math.max(760, zoneOrder.length * 240);
        const height = Math.max(420, maxZoneSize * 24 + 90);
        graphSvg.setAttribute('width', String(width));
        graphSvg.setAttribute('height', String(height));

        const positions = new Map();
        zoneOrder.forEach((zone, zoneIndex) => {
          const zoneNodes = nodesByZone.get(zone);
          const x = 110 + zoneIndex * ((width - 220) / Math.max(1, zoneOrder.length - 1));
          zoneNodes.forEach((node, nodeIndex) => {
            const y = 56 + nodeIndex * 24;
            positions.set(node.id, { x, y });
          });
        });

        const selected = selectedNodeId ? nodeById.get(selectedNodeId) : null;
        const selectedAdjacency = new Set();
        if (selected) {
          selectedAdjacency.add(selected.id);
          selected.internalImports.forEach((id) => selectedAdjacency.add(id));
          selected.importedBy.forEach((id) => selectedAdjacency.add(id));
        }

        const parts = [];
        zoneOrder.forEach((zone, zoneIndex) => {
          const x = 110 + zoneIndex * ((width - 220) / Math.max(1, zoneOrder.length - 1));
          parts.push('<text x="' + x + '" y="22" text-anchor="middle" fill="#495979" font-size="12">' + zone + '</text>');
          parts.push('<line x1="' + x + '" y1="30" x2="' + x + '" y2="' + (height - 12) + '" stroke="#eef2f8" stroke-width="1" />');
        });

        visibleEdges.forEach((edge) => {
          const sourcePoint = positions.get(edge.source);
          const targetPoint = positions.get(edge.target);
          if (!sourcePoint || !targetPoint) return;

          const edgeTouchesSelection = selected && (edge.source === selected.id || edge.target === selected.id);
          const opacity = selected ? (edgeTouchesSelection ? 0.85 : 0.08) : 0.2;
          const stroke = edgeTouchesSelection ? '#1f6feb' : '#91a0ba';
          parts.push(
            '<line x1="' + sourcePoint.x + '" y1="' + sourcePoint.y + '" x2="' + targetPoint.x + '" y2="' + targetPoint.y +
            '" stroke="' + stroke + '" stroke-opacity="' + opacity + '" stroke-width="1.3" />'
          );
        });

        visibleNodes.forEach((node) => {
          const point = positions.get(node.id);
          if (!point) return;

          const color = zoneColorById.get(node.zone) || '#5f7f98';
          const isSelected = node.id === selectedNodeId;
          const radius = isSelected ? 6.2 : 4.2;
          const opacity = selected ? (selectedAdjacency.has(node.id) ? 1 : 0.26) : 0.9;
          const stroke = isSelected ? '#0c2d61' : '#ffffff';
          parts.push(
            '<circle class="graph-node" data-node-id="' + node.id + '" cx="' + point.x + '" cy="' + point.y + '" r="' + radius +
            '" fill="' + color + '" fill-opacity="' + opacity + '" stroke="' + stroke + '" stroke-width="1.3">' +
            '<title>' + node.id + ' | out ' + node.internalImportCount + ' | in ' + node.importedByCount + '</title></circle>'
          );
        });

        if (selected && positions.has(selected.id)) {
          const point = positions.get(selected.id);
          parts.push('<text x="' + (point.x + 10) + '" y="' + (point.y - 8) + '" fill="#22324c" font-size="11">' + selected.id + '</text>');
        }

        graphSvg.innerHTML = parts.join('');
        graphSvg.querySelectorAll('.graph-node').forEach((circle) => {
          circle.style.cursor = 'pointer';
          circle.addEventListener('click', () => {
            selectedNodeId = circle.getAttribute('data-node-id');
            rerender();
          });
        });
      }

      function rerender() {
        const visibleNodes = getVisibleNodes();
        ensureSelectedNode(visibleNodes);
        renderNodeList(visibleNodes);
        renderGraph(visibleNodes);
        renderDetails(selectedNodeId ? nodeById.get(selectedNodeId) : null);
      }

      searchInput.addEventListener('input', rerender);
      zoneFilter.addEventListener('change', rerender);
      clearFilters.addEventListener('click', () => {
        searchInput.value = '';
        zoneFilter.value = '';
        rerender();
      });

      fillSummary();
      fillZoneFilter();
      renderZoneEdges();
      rerender();
    </script>
  </body>
</html>